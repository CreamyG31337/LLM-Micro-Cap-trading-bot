+-----------------------------------------------------------------------------+
|                      * Trading System Initialization *                      |
+-----------------------------------------------------------------------------+
2025-10-06 22:19:42,231 - __main__ - INFO - Logging configured - Level: INFO
2025-10-06 22:19:42,232 - portfolio.fund_manager - INFO - Loading funds from funds.yml
2025-10-06 22:19:42,236 - portfolio.fund_manager - INFO - Loaded 5 funds
2025-10-06 22:19:42,260 - __main__ - INFO - Market configuration module available
2025-10-06 22:19:42,263 - __main__ - INFO - Dual currency module available
2025-10-06 22:19:42,263 - __main__ - INFO - Pandas-datareader available for Stooq fallback
2025-10-06 22:19:42,263 - __main__ - INFO - Rich display libraries available
* Command line data directory override: trading_data/funds/TEST
* Data directory doesn't match any fund, using default fund: Project Chimera
* 
============================================================
*   * DEVELOPMENT ENVIRONMENT *
*   [BANK] Fund: TEST
*   [LIST] Type: WEALTHSIMPLE
*   * Data Directory: trading_data/funds/TEST
*   !  Safe to modify - This is test data
* ============================================================

2025-10-06 22:19:42,289 - __main__ - INFO - Initializing supabase repository for fund: Project Chimera
2025-10-06 22:19:42,289 - data.repositories.repository_factory - INFO - Cleared all repository instances
2025-10-06 22:19:44,319 - data.repositories.supabase_repository - INFO - Supabase client initialized successfully
2025-10-06 22:19:44,319 - __main__ - INFO - Repository initialized: SupabaseRepository
2025-10-06 22:19:44,319 - __main__ - INFO - Initializing system components...
2025-10-06 22:19:44,319 - portfolio.portfolio_manager - INFO - Portfolio manager initialized for fund 'Project Chimera' with SupabaseRepository
2025-10-06 22:19:45,322 - portfolio.position_calculator - INFO - Position calculator initialized with SupabaseRepository
2025-10-06 22:19:45,323 - portfolio.trading_interface - INFO - Trading interface initialized
2025-10-06 22:19:45,497 - __main__ - INFO - All system components initialized successfully
* System initialization completed successfully
+-----------------------------------------------------------------------------+
|                      * Portfolio Management Workflow *                      |
+-----------------------------------------------------------------------------+
INFO Creating data backup...
2025-10-06 22:19:45,640 - utils.backup_manager - INFO - Created backup '20251006_221945' with 5 files: llm_trade_log.csv, llm_portfolio_update.csv, fund_contributions.csv, exchange_rates.csv, cash_balances.json
* Backup created: 20251006_221945
* Terminal width may be too narrow for optimal table display
*    Current width: 80 characters
*    Recommended: 130+ characters for best experience
* 
* Command Prompt detected - To fix this:
*    1. Right-click title bar -> Properties -> Layout
*    2. Set 'Window Size Width' to 130 or higher
*    3. Or maximize this window (click maximize button)
*    4. Or press F11 for full screen mode
*    5. Consider upgrading to Windows Terminal for better experience
* 
INFO Loading portfolio data...
2025-10-06 22:19:45,655 - __main__ - INFO - Repository type: SupabaseRepository
2025-10-06 22:19:45,655 - __main__ - INFO - Repository fund: TEST
2025-10-06 22:19:46,072 - __main__ - INFO - Snapshot has 24 positions
2025-10-06 22:19:46,072 - __main__ - INFO -   CTRN: 'Citi Trends, Inc.'
2025-10-06 22:19:46,072 - __main__ - INFO -   VEE.TO: 'Vanguard FTSE Emerging Markets All Cap Index ETF'
2025-10-06 22:19:46,072 - __main__ - INFO -   XMA.TO: 'iShares S&P/TSX Capped Materials Index ETF'
2025-10-06 22:19:46,073 - __main__ - INFO -   DRX.TO: 'ADF Group Inc.'
* Loaded portfolio with 24 positions
INFO Updating exchange rates...
INFO Fetching current market data...
2025-10-06 22:19:49,786 - yfinance - ERROR - $TEST: possibly delisted; no price data found  (1d 2025-09-21 22:19:47.420393 -> 2025-10-06 22:19:47.420393)
2025-10-06 22:19:53,017 - yfinance - ERROR - HTTP Error 404: 
2025-10-06 22:19:53,091 - yfinance - ERROR - $TEST.TO: possibly delisted; no timezone found
2025-10-06 22:19:53,360 - yfinance - ERROR - $TEST.V: possibly delisted; no timezone found
2025-10-06 22:19:53,407 - yfinance - ERROR - $TEST: possibly delisted; no price data found  (period=1d)
2025-10-06 22:19:53,447 - yfinance - ERROR - $TEST: possibly delisted; no price data found  (period=5d)
2025-10-06 22:19:53,449 - market_data.data_fetcher - ERROR - TEST: All strategies failed ()
2025-10-06 22:19:53,450 - __main__ - WARNING - Failed to fetch data for TEST: cannot access local variable 'pd' where it is not associated with a value
* Portfolio workflow failed: cannot access local variable 'pd' where it is not 
associated with a value
2025-10-06 22:19:53,452 - __main__ - ERROR - Portfolio workflow failed: cannot access local variable 'pd' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\cream\OneDrive\Documents\LLM-Micro-Cap-trading-bot\trading_script.py", line 1109, in run_portfolio_workflow
    market_data[ticker] = pd.DataFrame()
                          ^^
UnboundLocalError: cannot access local variable 'pd' where it is not associated with a value

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\cream\OneDrive\Documents\LLM-Micro-Cap-trading-bot\trading_script.py", line 1114, in run_portfolio_workflow
    market_data[ticker] = pd.DataFrame()
                          ^^
UnboundLocalError: cannot access local variable 'pd' where it is not associated with a value
* Unexpected error: cannot access local variable 'pd' where it is not 
associated with a value
2025-10-06 22:19:53,458 - __main__ - ERROR - Unexpected error in main
Traceback (most recent call last):
  File "C:\Users\cream\OneDrive\Documents\LLM-Micro-Cap-trading-bot\trading_script.py", line 1109, in run_portfolio_workflow
    market_data[ticker] = pd.DataFrame()
                          ^^
UnboundLocalError: cannot access local variable 'pd' where it is not associated with a value

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\cream\OneDrive\Documents\LLM-Micro-Cap-trading-bot\trading_script.py", line 2321, in main
    run_portfolio_workflow(args, system_settings, system_repository, trading_interface, fund_manager, clear_caches=False)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cream\OneDrive\Documents\LLM-Micro-Cap-trading-bot\trading_script.py", line 1114, in run_portfolio_workflow
    market_data[ticker] = pd.DataFrame()
                          ^^
UnboundLocalError: cannot access local variable 'pd' where it is not associated with a value
2025-10-06 22:19:53,464 - __main__ - INFO - System cleanup completed
